---
layout: post
title: Determining at Fault Party in Fatal Crash
category: data
---
![]({{ site.baseurl }}/assets/images/03-banner.png)
{: .image.featured}
The third project I worked on is trying to predict whether someone is at fault or not in a fatal accident based on vehicle and driver features. The dataset I worked with is from the National Highway Traffic Safety Administration (NHTSA) for all fatal crashes in the year 2015. The NHTSA has published the data in order for people to better understand the factors that might have caused these accidents, and hope there will be solutions to minimize them in the future. The dataset itself is very extensive, with information ranging from detailed VIN information about the car to step by step events leading up to the accident. For the purpose of this analysis, I will only be using a subset of the available data, due to the fact many of the details are unavailable for most accidents, and reduced dimensionality can decrease problems such as overfitting.
The most important questions is how to classify the responsible party. Luckily the database contains information on whether a person is charged with a moving violation or not. In addition there is a column in the dataset on whether the driver was drinking. So in summary I have determined the driver who were charged or were drinking are considered at fault. On the other hand the people who are not liable were not charged and not drinking, plus one important criteria that they were alive after the accident. This additional quantifier is needed because it is reasonable to expect the court system not charge someone who is already dead, even though they might have been responsible for the accident. With this classification, I then did a train test split of the data at 70/30 ratio. There are some curious cases with this classification, where in some cases a person who were dead was being charged, and in other cases person who were drinking and were alive wasn’t being charged.
The next part is identifying the features that might be useful in the model. I grouped the features into two classes, vehicle features and driver features. For vehicle features I decided, the year, make, and vehicle type are the most important. I was originally going to use the car model as a feature, however the dependency of model on the make of the car is difficult to work with. Grouping the data by car type make comparison a lot easier, as most manufacturers only have a few models of the same type. In the end I further grouped the vehicle type into 10 categories consisting of motorcycle, 2-door and convertible, 4-door sedan, SUV, minivan, van, pickup, truck, bus, and other. Driver features that are common in the database are age and gender, other information such as weight and height are sparsely available, many other more specific information are only present when the driver is dead, which is not very useful in this classification scheme. I used Gradient Boosting classification with AUC 0.7288, Log loss 0.5759 and Random Forest method with AUC 0.7255, Log loss 0.5775. Both method show similar results, however what I am interested here is actually not the classification, but clustering to give the probability of being liable.
![]({{ site.baseurl }}/assets/images/03-b1.png "2 vs 4 doors")

The first plot is a comparison between two general body types (2-door plus convertibles and 4-door sedans). The y-axis is the probability of being liable, and the x-axis is the year of the car. The colors are blue for men, and red for women. It’s clear in this dataset there are more 4-door vehicles than 2-door ones, the mean for newer cars are between 0.3 and 0.4, reflecting the null base dataset where the ratio of liable vs not liable drivers is about 1 to 2. With older cars, the predicted probability increases slightly, but the main difference is between male and female drivers, where female drivers are predicted to have a lower likelihood of being liable.

![]({{ site.baseurl }}/assets/images/03-b2.png "pickup vs minivan")

The next figure compares the difference between pickup trucks and minivan. More differences in model years can be seen, where models less than 5 years old are less likely to be responsible in a fatal accident. Overall the predicted value for minivans are lower, perhaps due to comparatively more female drivers. Older pickup trucks has a higher than average chance of being responsible for an accident.

![]({{ site.baseurl }}/assets/images/03-b3.png "motorcycle vs bus/truck")

The final vehicle body type comparison is between motorcycles and buses/trucks. The predicted probabilities for motorcycles are all extremely high, often close to one. This does not necessarily mean motorcyclist are always responsible in a fatal accident, but is more a feature of how I defined someone being responsible or not. In my definition, someone is not responsible if they are not charged, did not drink, and did not die in an accident, unfortunately in vast majority of fatal accident involving motorcyclists, the driver is died. This means for almost all cases a motorcycle rider cannot be classified as not responsible, but they can be considered responsible if they were drinking even when they are died, in addition sometimes they might be charged with a moving violation as well. Truck and bus drivers on the other hand are almost always not responsible, perhaps due to the professional nature of their driving compared to other drivers. In addition, those large vehicles cannot evade and drive defensively as well as smaller cars, thus they might be involved in more accidents when they are not the responsible party.

![]({{ site.baseurl }}/assets/images/03-c.png "german cars")

As an example of comparing car makers, this is a plot of select German car companies. The circles are female drivers, while squares are male drivers. The colors are now the 10 different class of vehicles. Different makes of cars did not make too much of a difference in the predicted probability. With Porsches, there is a very small sample size, but perhaps due to the car type being all 2-doors, the predicted probability for those 4 points are a bit high at close to 0.60.

![]({{ site.baseurl }}/assets/images/03-d.png "genders")

Finally a plot can be made with varying age and gender. Once again with female being red and male being blue. At a first glance, the motorcycle and bus/tuck regions are clearly visible near the top and bottom respectively. Probability for female drivers are centered around 0.3, while male drivers between the age of 19 and 30 have a much higher probability, perhaps this means the insurance companies were right. Drivers over 85 also show higher chance of being liable, although there are fewer data points available. There are also a few 11 year olds in the data, not surprisingly they were not considered liable, since they were not charged. The gender difference is perhaps not only due to driving styles, were men might drive more aggressively, but also might be due to women being less likely to be charged, and perhaps differences in defensive driving similar to the bus/truck case.
